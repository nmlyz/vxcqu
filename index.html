<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>イラスト依頼テンプレ作成</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>イラスト依頼テンプレ作成</h2>

<!-- 種類の選択 -->
<div id="typeSelector">
  <label class="select-btn">
    <input type="radio" name="type" value="nyanzu" checked>
    にゃんず量産🐈‍⬛
  </label>
  <label class="select-btn">
    <input type="radio" name="type" value="ganbare">
    がんばれ！量産
  </label>
</div>

<!-- フォーム -->
<form id="formArea" class="form-area"></form>

<!-- プレビュー -->
<h3>テンプレプレビュー</h3>
<textarea id="templatePreview" readonly></textarea>

<!-- Twitter送信・コピー -->
<div class="action-area">
  <button id="sendButton">Twitterで送信</button>
  <button id="copyButton">テンプレをコピー</button>
</div>

<script>
  const formArea = document.getElementById('formArea');
  const preview = document.getElementById('templatePreview');
  const sendButton = document.getElementById('sendButton');
  const copyButton = document.getElementById('copyButton');

  const templates = {
    nyanzu: {
      title: '【 にゃんず量産🐈‍⬛ 】',
      fields: [
        '早期', '左右', '性別', '髪型', '髪色', '目色',
        '服色', '小物', '猫耳（あり or なし）'
      ],
      footer: '※猫色固定'
    },
    ganbare: {
      title: '【 がんばれ！量産 】',
      fields: [
        '早期', '左右', '性別', '髪型', '髪色', '目色',
        '体操服色', 'ゼッケンの文字', '小物'
      ],
      footer: '※体操服とハチマキの色は同色になります'
    }
  };

  let currentType = 'nyanzu';

  function createEarlyField() {
  const container = document.createElement('div');
  container.className = 'input-box';
  
  const label = document.createElement('label');
  label.textContent = '早期 ╎ ';
  container.appendChild(label);
  
  const radioWrap = document.createElement('div');
  radioWrap.className = 'radio-wrap';
  
  const yesLabel = document.createElement('label');
  yesLabel.innerHTML = `<input type="radio" name="early_toggle" value="あり" checked> あり`;
  
  const noLabel = document.createElement('label');
  noLabel.innerHTML = `<input type="radio" name="early_toggle" value="なし"> なし`;
  
  radioWrap.appendChild(yesLabel);
  radioWrap.appendChild(noLabel);
  container.appendChild(radioWrap);
  
  // ▼ 選択肢（ありの下に出す）
  const select = document.createElement('select');
  select.name = '早期';
  ['24h', '3日', '7日'].forEach(opt => {
    const o = document.createElement('option');
    o.value = opt;
    o.textContent = opt;
    select.appendChild(o);
  });
  select.className = 'early-options';
  container.appendChild(select);
  
  // 初期状態
  select.style.display = 'block';
  
  container.querySelectorAll('input[name="early_toggle"]').forEach(radio => {
    radio.addEventListener('change', () => {
      select.style.display = radio.value === 'あり' ? 'block' : 'none';
      updatePreview();
    });
  });
  
  return container;
}

  function renderForm() {
    const template = templates[currentType];
    formArea.innerHTML = '';

    template.fields.forEach(field => {
      if (field.startsWith('早期')) {
        formArea.appendChild(createEarlyField());
        return;
      }
      
      // ▼ この if を追加（猫耳だけ選択式に）
      if (field.includes('猫耳')) {
        const box = document.createElement('div');
        box.className = 'input-box';
        
        const label = document.createElement('label');
        label.textContent = `${field} ╎ `;
        box.appendChild(label);
        
        const select = document.createElement('select');
        select.name = field;
        ['あり', 'なし'].forEach(opt => {
          const o = document.createElement('option');
          o.value = opt;
          o.textContent = opt;
          select.appendChild(o);
        });
        
        box.appendChild(select);
        formArea.appendChild(box);
        return;
      }

      const box = document.createElement('div');
      box.className = 'input-box';

      const label = document.createElement('label');
      label.textContent = `${field} ╎ `;

      const input = document.createElement('input');
      input.type = 'text';
      input.name = field;
      input.placeholder = `${field}を入力`;

      box.appendChild(label);
      box.appendChild(input);
      formArea.appendChild(box);
    });

    updatePreview();
  }

  function updatePreview() {
    const template = templates[currentType];
    const inputs = formArea.querySelectorAll('input[type="text"], select');
    let result = `${template.title}\n`;

    const earlyToggle = document.querySelector('input[name="early_toggle"]:checked');
    if (earlyToggle) {
      const earlyValue = earlyToggle.value === 'あり'
        ? document.querySelector('select[name="早期"]').value
        : 'なし';
      result += `早期 ╎ ${earlyValue}\n`;
    }

    inputs.forEach(input => {
      if (input.name !== '早期') {
        result += `${input.name} ╎ ${input.value}\n`;
      }
    });

    result += `\n${template.footer}`;
    preview.value = result;
  }

  document.querySelectorAll('input[name="type"]').forEach(radio => {
    radio.addEventListener('change', (e) => {
      currentType = e.target.value;
      renderForm();
      document.querySelectorAll('.select-btn').forEach(label => {
        label.classList.toggle('selected', label.querySelector('input').checked);
      });
    });
  });

  formArea.addEventListener('input', updatePreview);
  formArea.addEventListener('change', updatePreview);

  sendButton.addEventListener('click', () => {
    const message = encodeURIComponent(preview.value);
    const url = `https://twitter.com/messages/compose?recipient_id=1892974018548080640&text=${message}`;
    window.open(url, '_blank');
  });

  copyButton.addEventListener('click', () => {
    navigator.clipboard.writeText(preview.value);
    copyButton.textContent = 'コピーしました！';
    setTimeout(() => (copyButton.textContent = 'テンプレをコピー'), 1500);
  });

  // 初期
  document.querySelectorAll('.select-btn').forEach(label => {
    label.classList.toggle('selected', label.querySelector('input').checked);
  });
  renderForm();
</script>

</body>
</html>